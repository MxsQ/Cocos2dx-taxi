{"version":3,"sources":["file:///Users/qinx/coding/cocos2dx/Cocos2dx-taxi/assets/script/data/Configuration.ts"],"names":["_decorator","Component","Constants","ccclass","property","Configuration","instance","_instance","init","localStorage","cc","sys","getItem","GameConfigID","_jsonData","JSON","parse","setInterval","_scheduleSave","getConfigData","key","data","setConfigData","value","_markSave","stringify","setItem"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AACZC,MAAAA,S,cAAAA,S;;;;;;;AACDC,MAAAA,O,GAAsBH,U,CAAtBG,O;AAASC,MAAAA,Q,GAAaJ,U,CAAbI,Q;;+BAGJC,a,WADZF,OAAO,CAAC,eAAD,C;;;;;;;;;;;;sEAEc,E;;sEACA,K;;;;;sBAGNG,Q,GAAd,oBAAyB;AACvB,cAAI,CAAC,KAAKC,SAAV,EAAqB;AACnB,iBAAKA,SAAL,GAAiB,IAAIF,aAAJ,EAAjB;AACD;;AAED,iBAAO,KAAKE,SAAZ;AACD,S;;;;eAEMC,I,GAAP,gBAAc;AACZ,cAAMC,YAAY,GAAGC,EAAE,CAACC,GAAH,CAAOF,YAAP,CAAoBG,OAApB,CAA4B;AAAA;AAAA,sCAAUC,YAAtC,CAArB;;AACA,cAAIJ,YAAJ,EAAkB;AAChB,iBAAKK,SAAL,GAAiBC,IAAI,CAACC,KAAL,CAAWP,YAAX,CAAjB;AACD;;AAEDQ,UAAAA,WAAW,CAAC,KAAKC,aAAN,EAAqB,GAArB,CAAX;AACD,S;;eAEMC,a,GAAP,uBAAqBC,GAArB,EAAkC;AAChC,cAAMC,IAAI,GAAG,KAAKP,SAAL,CAAeM,GAAf,CAAb;AACA,iBAAOC,IAAI,IAAI,EAAf;AACD,S;;eAEMC,a,GAAP,uBAAqBF,GAArB,EAAkCG,KAAlC,EAAiD;AAC/C,eAAKT,SAAL,CAAeM,GAAf,IAAsBG,KAAtB;AACA,eAAKC,SAAL,GAAiB,IAAjB;AACD,S;;eAEON,a,GAAR,yBAAwB;AACtB,cAAI,CAAC,KAAKM,SAAV,EAAqB;AACnB;AACD;;AAED,cAAMH,IAAI,GAAGN,IAAI,CAACU,SAAL,CAAe,KAAKX,SAApB,CAAb;AACAJ,UAAAA,EAAE,CAACC,GAAH,CAAOF,YAAP,CAAoBiB,OAApB,CAA4B;AAAA;AAAA,sCAAUb,YAAtC,EAAoDQ,IAApD;AACA,eAAKG,SAAL,GAAiB,KAAjB;AACD,S;;;QAxCgCvB,S,yCAIC,I","sourcesContent":["\nimport { _decorator, Component, Node } from 'cc';\nimport { Constants } from './Constants';\nconst { ccclass, property } = _decorator;\n\n@ccclass('Configuration')\nexport class Configuration extends Component {\n  private _jsonData = {};\n  private _markSave = false;\n\n  static _instance: Configuration = null;\n  public static instance() {\n    if (!this._instance) {\n      this._instance = new Configuration();\n    }\n\n    return this._instance;\n  }\n\n  public init() {\n    const localStorage = cc.sys.localStorage.getItem(Constants.GameConfigID);\n    if (localStorage) {\n      this._jsonData = JSON.parse(localStorage);\n    }\n\n    setInterval(this._scheduleSave, 500);\n  }\n\n  public getConfigData(key: string) {\n    const data = this._jsonData[key];\n    return data || '';\n  }\n\n  public setConfigData(key: string, value: string) {\n    this._jsonData[key] = value;\n    this._markSave = true;\n  }\n\n  private _scheduleSave() {\n    if (!this._markSave) {\n      return;\n    }\n\n    const data = JSON.stringify(this._jsonData);\n    cc.sys.localStorage.setItem(Constants.GameConfigID, data);\n    this._markSave = false;\n  }\n}"]}